{"version":3,"file":"js/148.67492a3b.js","mappings":"qGAAe,SAASA,EAAeC,EAAOC,EAAW,OACvD,OAAO,IAAIC,KAAKC,aAAa,QAAS,CACpCC,MAAO,WACPH,aACCI,OAAOL,EACZ,C,mICJOM,MAAM,Y,GAIFA,MAAM,c,GACTC,EAAAA,EAAAA,GAAqB,UAAjB,gBAAY,G,SAIfD,MAAM,U,SAGNA,MAAM,U,aASAA,MAAM,Y,kGArBnBE,EAAAA,EAAAA,IAgCM,MAhCNC,EAgCM,EA7BJF,EAAAA,EAAAA,GA2BM,aA1BJA,EAAAA,EAAAA,GAGM,MAHNG,EAGM,CAFJC,GACAJ,EAAAA,EAAAA,GAAmC,mBAA5BK,EAAAA,eAAeA,EAAAA,OAAI,KAEXA,EAAAA,UAAO,WAAxBC,EAAAA,EAAAA,IAA2BC,EAAAA,CAAAC,IAAAA,KACGH,EAAAA,WAGAA,EAAAA,U,WAG9BJ,EAAAA,EAAAA,IAcU,4BAbRA,EAAAA,EAAAA,IAYMQ,EAAAA,GAAAA,MAAAA,EAAAA,EAAAA,IAZaJ,EAAAA,YAAPK,K,WAAZT,EAAAA,EAAAA,IAYM,OAZ0BO,IAAKE,EAAIC,I,EACvCX,EAAAA,EAAAA,GAGI,WAFFA,EAAAA,EAAAA,GAAiC,uBAAtBU,EAAIE,OAAQ,IAAC,YAAS,KACjC,QAAGP,EAAAA,eAAeK,EAAIG,QAAS,QAAI,QAAGR,EAAAA,eAAeK,EAAII,QAAK,MAEhEd,EAAAA,EAAAA,GAMM,MANNe,EAMM,EALJf,EAAAA,EAAAA,GAIO,OAHLD,OAAK,SAAC,cAAa,CACVW,EAAIM,iBACZnB,OAAK,SAAAoB,MAAUP,EAAIQ,gBAAkB,O,0BAbT,WAArCjB,EAAAA,EAAAA,IAEI,IAFJkB,EAEI,UAFmC,uBACrC,QAAuDC,EAAAA,CAA1CC,GAAG,WAAS,C,kBAAC,IAAe,UAAf,sB,WAJY,WAAxCpB,EAAAA,EAAAA,IAEI,IAFJqB,EAEI,UAFsC,yBACxC,QAA8DF,EAAAA,CAAjDC,GAAG,eAAa,C,kBAAC,IAAkB,UAAlB,yB,uDA+BtC,GACEE,WAAY,CAACC,UAASA,EAAAA,GACtBC,QACE,MAAMC,GAAQC,EAAAA,EAAAA,MACRC,GAAOC,EAAAA,EAAAA,KAAS,IAAMH,EAAMI,QAAQ,aAAaF,OACjDG,GAAUC,EAAAA,EAAAA,KAAI,GACdC,GAAaD,EAAAA,EAAAA,IAAI,IACjBE,GAAUF,EAAAA,EAAAA,IAAI,IAgCpB,OA/BAG,EAAAA,EAAAA,KAAUC,UACRL,EAAQtC,OAAQ,EAChByC,EAAQzC,YAAciC,EAAMW,SAAS,wBACrC,MAAMC,QAAiBZ,EAAMW,SAAS,2BAClCC,GAAYJ,EAAQzC,MACtBwC,EAAWxC,MAAQ6C,EAASC,KAAI7B,IAC9B,MAAMG,EAAQqB,EAAQzC,MACnB+C,QAAOC,GAAKA,EAAEC,aAAehC,EAAIC,KACjC6B,QAAOC,GAAgB,YAAXA,EAAEE,OACdC,QAAO,CAACC,EAAOC,IACPD,IAAUC,EAAOC,QACvB,GACCC,EAAU,IAAMnC,EAAQH,EAAII,MAC5BI,EAAkB8B,EAAU,IAAM,IAAMA,EACxChC,EAAgBgC,EAAU,GAC5B,QACAA,EAAU,IACR,SACA,MACN,MAAO,IACFtC,EACHQ,kBACAF,gBACAH,QACD,IAGHoB,EAAWxC,MAAQ6C,EAErBP,EAAQtC,OAAQ,CAAI,IAEf,CACLsC,UACAE,aACAL,OACApC,eAAc,IACd0C,UAEJ,G,QCnFF,MAAMe,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,KAEpE,O","sources":["webpack://srm/./src/utils/currencyFilter.js","webpack://srm/./src/views/MainPlanning.vue","webpack://srm/./src/views/MainPlanning.vue?715f"],"sourcesContent":["export default function currencyFilter(value, currency = 'RUB') {\n  return new Intl.NumberFormat('ru-RU', {\n    style: 'currency',\n    currency\n  }).format(value)\n}\n","<template>\n  <div class=\"app-page\">\n\n\n    <div>\n      <div class=\"page-title\">\n        <h3>Планирование</h3>\n        <h4>{{ currencyFilter(bill) }}</h4>\n      </div>\n      <AppLoader v-if=\"loading\"/>\n      <p class=\"center\" v-else-if=\"!categories\">Категорий пока нет.\n        <router-link to=\"/categories\">Добавить категорию</router-link>\n      </p>\n      <p class=\"center\" v-else-if=\"!records\">Записей пока нет.\n        <router-link to=\"/record\">Добавить запись</router-link>\n      </p>\n      <section v-else>\n        <div v-for=\"cat in categories\" :key=\"cat.id\">\n          <p>\n            <strong>{{ cat.title }}:</strong>\n            {{ currencyFilter(cat.spend) }} из {{ currencyFilter(cat.limit) }}\n          </p>\n          <div class=\"progress\">\n            <div\n              class=\"determinate\"\n              :class=\"[cat.progressColor]\"\n              :style=\"{width: cat.progressPercent + '%'}\"\n            ></div>\n          </div>\n        </div>\n      </section>\n    </div>\n\n  </div>\n</template>\n\n<script>\nimport {computed, onMounted, ref} from \"vue\";\nimport {useStore} from \"vuex\";\nimport AppLoader from \"@/components/app/AppLoader\";\nimport currencyFilter from \"@/utils/currencyFilter\"\n\nexport default {\n  components: {AppLoader},\n  setup() {\n    const store = useStore()\n    const bill = computed(() => store.getters['auth/info'].bill)\n    const loading = ref(false)\n    const categories = ref([])\n    const records = ref([])\n    onMounted(async () => {\n      loading.value = true\n      records.value = await store.dispatch('record/getAllRecords')\n      const category = await store.dispatch('category/getAllCategory')\n      if (category && records.value) {\n        categories.value = category.map(cat => {\n          const spend = records.value\n            .filter(r => r.categoryId === cat.id)\n            .filter(r => r.type === 'outcome')\n            .reduce((total, record) => {\n              return total += +record.amount\n            }, 0)\n          const percent = 100 * spend / cat.limit\n          const progressPercent = percent > 100 ? 100 : percent\n          const progressColor = percent < 60\n            ? 'green'\n            : percent < 100\n              ? 'yellow'\n              : 'red'\n          return {\n            ...cat,\n            progressPercent,\n            progressColor,\n            spend\n          }\n        })\n      } else {\n        categories.value = category\n      }\n      loading.value = false\n    })\n    return {\n      loading,\n      categories,\n      bill,\n      currencyFilter,\n      records\n    }\n  }\n}\n</script>\n\n<style scoped>\n\n</style>\n","import { render } from \"./MainPlanning.vue?vue&type=template&id=a967f478\"\nimport script from \"./MainPlanning.vue?vue&type=script&lang=js\"\nexport * from \"./MainPlanning.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"D:\\\\fullstack\\\\projects\\\\Frontend\\\\VUEJS\\\\crm\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["currencyFilter","value","currency","Intl","NumberFormat","style","format","class","_createElementVNode","_createElementBlock","_hoisted_1","_hoisted_2","_hoisted_3","$setup","_createBlock","_component_AppLoader","key","_Fragment","cat","id","title","spend","limit","_hoisted_7","progressColor","width","progressPercent","_hoisted_5","_component_router_link","to","_hoisted_4","components","AppLoader","setup","store","useStore","bill","computed","getters","loading","ref","categories","records","onMounted","async","dispatch","category","map","filter","r","categoryId","type","reduce","total","record","amount","percent","__exports__","render"],"sourceRoot":""}