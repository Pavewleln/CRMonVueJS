(function(){"use strict";var e={8258:function(e,t,a){var n=a(9242),r=a(3396);function o(e,t,a,n,o,s){return(0,r.wg)(),(0,r.iD)("div",null,[n.layout?((0,r.wg)(),(0,r.j4)((0,r.LL)(n.layout+"-layout"),{key:0})):(0,r.kq)("",!0)])}var s=a(7139);const i={key:1,class:"app-main-layout"},c={class:"fixed-action-btn"},u=(0,r._)("i",{class:"large material-icons"},"add",-1);function l(e,t,a,n,o,l){const d=(0,r.up)("AppLoader"),p=(0,r.up)("TheNavbar"),g=(0,r.up)("TheSidebar"),m=(0,r.up)("router-view"),h=(0,r.up)("router-link");return(0,r.wg)(),(0,r.iD)("div",null,[n.loading?((0,r.wg)(),(0,r.j4)(d,{key:0})):((0,r.wg)(),(0,r.iD)("div",i,[(0,r.Wm)(p,{onToggleSidebar:t[0]||(t[0]=e=>n.sidebarState=!n.sidebarState)}),(0,r.Wm)(g,{value:n.sidebarState},null,8,["value"]),(0,r._)("main",{class:(0,s.C_)(["app-content",{full:!n.sidebarState}])},[(0,r.Wm)(m)],2),(0,r._)("div",c,[(0,r.Wm)(h,{class:"btn-floating btn-large blue",to:"/record"},{default:(0,r.w5)((()=>[u])),_:1})])]))])}var d=a(4870);function p(e,t,a,n,o,i){const c=(0,r.up)("router-link");return(0,r.wg)(),(0,r.iD)("ul",{class:(0,s.C_)(["sidenav app-sidenav",{open:a.value}])},[(0,r._)("li",null,[(0,r.Wm)(c,{to:"/",class:"waves-effect waves-orange pointer"},{default:(0,r.w5)((()=>[(0,r.Uk)("Счет")])),_:1})]),(0,r._)("li",null,[(0,r.Wm)(c,{to:"/history",class:"waves-effect waves-orange pointer"},{default:(0,r.w5)((()=>[(0,r.Uk)("История")])),_:1})]),(0,r._)("li",null,[(0,r.Wm)(c,{to:"/planning",class:"waves-effect waves-orange pointer"},{default:(0,r.w5)((()=>[(0,r.Uk)("Планирование")])),_:1})]),(0,r._)("li",null,[(0,r.Wm)(c,{to:"/record",class:"waves-effect waves-orange pointer"},{default:(0,r.w5)((()=>[(0,r.Uk)("Новая запись")])),_:1})]),(0,r._)("li",null,[(0,r.Wm)(c,{to:"/categories",class:"waves-effect waves-orange pointer"},{default:(0,r.w5)((()=>[(0,r.Uk)("Категории")])),_:1})])],2)}var g={props:["value"]},m=a(89);const h=(0,m.Z)(g,[["render",p]]);var f=h;const v={class:"navbar orange lighten-1"},y={class:"nav-wrapper"},w={class:"navbar-left"},b=(0,r._)("i",{class:"material-icons black-text"},"dehaze",-1),k=[b],_={class:"black-text"},I={class:"right hide-on-small-and-down"},S={ref:"dropdown",class:"dropdown-trigger black-text",href:"#","data-target":"dropdown"},A=(0,r._)("i",{class:"material-icons right"},"arrow_drop_down",-1),T={id:"dropdown",class:"dropdown-content"},j=(0,r._)("i",{class:"material-icons"},"account_circle",-1),U=(0,r._)("li",{class:"divider",tabindex:"-1"},null,-1),P=(0,r._)("i",{class:"material-icons"},"assignment_return",-1);function C(e,t,a,o,i,c){const u=(0,r.up)("router-link");return(0,r.wg)(),(0,r.iD)("nav",v,[(0,r._)("div",y,[(0,r._)("div",w,[(0,r._)("a",{href:"#",onClick:t[0]||(t[0]=(0,n.iM)((t=>e.$emit("toggleSidebar")),["prevent"]))},k),(0,r._)("span",_,(0,s.zw)(o.date),1)]),(0,r._)("ul",I,[(0,r._)("li",null,[(0,r._)("a",S,[(0,r.Uk)((0,s.zw)(o.name.name)+" ",1),A],512),(0,r._)("ul",T,[(0,r._)("li",null,[(0,r.Wm)(u,{to:"/profile",class:"black-text"},{default:(0,r.w5)((()=>[j,(0,r.Uk)("Профиль ")])),_:1})]),U,(0,r._)("li",null,[(0,r._)("a",{href:"#",class:"black-text",onClick:t[1]||(t[1]=(0,n.iM)(((...e)=>o.logout&&o.logout(...e)),["prevent"]))},[P,(0,r.Uk)("Выйти ")])])])])])])])}a(7658);var D=a(2483),x=a(65),O={emits:["toggleSidebar"],setup(){const e=(0,x.oR)(),t=(0,D.tv)(),a=(0,d.iH)("");(0,r.bv)((()=>{window.M.Dropdown.init(a.value,{constrainWidth:!0})}));const n=()=>{t.push("/logout")},o=(0,r.Fl)((()=>e.getters["auth/info"])),s=(new Date).toLocaleDateString();return{logout:n,date:s,name:o,dropdown:a}}};const M=(0,m.Z)(O,[["render",C]]);var E=M,B=a(9877),L={components:{AppLoader:B.Z,TheNavbar:E,TheSidebar:f},setup(){const e=(0,x.oR)(),t=(0,d.iH)(!0),a=(0,d.iH)(!0);return(0,r.bv)((async()=>{await e.dispatch("auth/authMe"),e.getters["auth/info"]&&(a.value=!1)})),{sidebarState:t,loading:a}}};const N=(0,m.Z)(L,[["render",l]]);var R=N;const W={class:"grey darken-1 empty-layout"};function Z(e,t,a,n,o,s){const i=(0,r.up)("router-view");return(0,r.wg)(),(0,r.iD)("div",W,[(0,r.Wm)(i)])}var $={};const z=(0,m.Z)($,[["render",Z]]);var F=z,H={components:{AuthLayout:F,MainLayout:R},setup(){const e=(0,D.yj)(),t=(0,r.Fl)((()=>e.meta.layout));return{layout:t}}};const X=(0,m.Z)(H,[["render",o]]);var q=X,J=a(5431);(0,J.z)("/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline hooks.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(e){console.error("Error during service worker registration:",e)}});var Y=a(2316),G=a(6270),K=a(4311);const Q="jwt-token",V="jwt-refresh-token",ee="jwt-expires",te="user-local-id",ae=({refreshToken:e,idToken:t,localId:a,expiresIn:n=3600})=>{const r=(new Date).getTime()+1e3*n;localStorage.setItem(te,a),localStorage.setItem(Q,t),localStorage.setItem(V,e),localStorage.setItem(ee,r)},ne=()=>localStorage.getItem(Q),re=()=>localStorage.getItem(V),oe=()=>localStorage.getItem(ee);function se(){return localStorage.getItem(te)}function ie(){localStorage.removeItem(te),localStorage.removeItem(Q),localStorage.removeItem(V),localStorage.removeItem(ee)}const ce={setTokens:ae,getAccessToken:ne,getRefreshToken:re,getExpiresTokenDate:oe,getUserId:se,removeAuthData:ie},ue=K.Z.create(),le={register:async({email:e,password:t})=>{const a="https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=AIzaSyBBJXaYSrl1hjL6iwH4e84n_lsuAjz1Cbo",{data:n}=await ue.post(a,{email:e,password:t,returnSecureToken:!0});return n},login:async({email:e,password:t})=>{const a="https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=AIzaSyBBJXaYSrl1hjL6iwH4e84n_lsuAjz1Cbo",{data:n}=await ue.post(a,{email:e,password:t,returnSecureToken:!0});return n},refresh:async()=>{const e="https://securetoken.googleapis.com/v1/token?key=AIzaSyBBJXaYSrl1hjL6iwH4e84n_lsuAjz1Cbo",{data:t}=await ue.post(e,{grant_type:"refresh_token",refresh_token:ce.getRefreshToken()});return t}};var de=JSON.parse('{"_":"https://vuecrm-36607-default-rtdb.firebaseio.com/","g":true}');const pe=K.Z.create({baseURL:de._});pe.interceptors.request.use((async function(e){if(de.g){const t=/\/$/gi.test(e.url);e.url=(t?e.url.slice(0,-1):e.url)+".json";const a=ce.getExpiresTokenDate(),n=ce.getRefreshToken();if(a&&n<Date.now){const e=await le.refresh();ce.setTokens({refreshToken:e.refresh_token,idToken:e.id_token,localId:e.user_id,expiresIn:e.expires_in})}const r=ce.getAccessToken();r&&(e.params={...e.params,auth:r})}return e}),(function(e){return Promise.reject(e)})),pe.interceptors.response.use((e=>e),(function(e){const t=e.response&&e.response.status>=400&&e.response.status<500;return t||console.log(e),401===e.response.status&&je.push("/auth?message=auth"),Promise.reject(e)}));const ge={get:pe.get,post:pe.post,put:pe.put,delete:pe.delete,patch:pe.patch};var me=ge;const he="users/",fe={create:async e=>{const{data:t}=await me.put(he+e._id+"/info",e);return t},authMe:async()=>{const{data:e}=await me.get(he+ce.getUserId()+"/info");return e},updateBill:async(e,t)=>{await me.patch(`users/${e}/info`,t)},updateName:async(e,t)=>{await me.patch(`users/${e}/info`,t)}},ve="jwt-token",ye="user-local-id";var we={namespaced:!0,state(){return{token:ce.getAccessToken(),userId:ce.getUserId(),auth:{}}},mutations:{setToken(e,t){e.token=t.idToken,e.userId=t.localId,localStorage.setItem(ye,t.localId),localStorage.setItem(ve,t.idToken)},logout(e){e.token=null,e.auth=null,ce.removeAuthData()},setAuth(e,t){e.auth=t}},actions:{async login({commit:e},t){try{const a=await le.login(t);e("setToken",a),(0,Y.U)("Вы вошли в систему")}catch(a){throw(0,Y.P)(G.Z[a.response.data.error.message]),a}},async register({commit:e},t){try{const a=await le.register(t),n=a.localId;e("setToken",a);const r={_id:n,bill:1e4,...t},o=await fe.create(r);e("setAuth",o),(0,Y.U)("Вы вошли в систему")}catch(a){throw(0,Y.P)(G.Z[a.response.data.error.message]),a}},async authMe({commit:e}){const t=await fe.authMe();e("setAuth",t)},async updateInfo({commit:e,getters:t},a){try{const n=ce.getUserId(),r={...t.info,...a};await fe.updateBill(n,r),e("setAuth",r)}catch(n){(0,Y.P)(n)}},async updateInfoName({commit:e,getters:t},a){try{const n=ce.getUserId(),r={...t.info,...a};await fe.updateName(n,r),e("setAuth",r)}catch(n){(0,Y.P)(n)}}},getters:{info(e){return e.auth},userId(e){return e.userId},isAuthenticated(e){return!!e.token}}};const be={get:async e=>{const{data:t}=await me.get(`users/${e}/categories`);return t},create:async(e,t)=>{const{data:a}=await me.post(`users/${t}/categories`,e);return a},update:async(e,t)=>{const{data:a}=await me.patch(`users/${t}/categories/${e.id}`,e);return a},getById:async(e,t)=>{const{data:a}=await me.get(`/users/${e}/categories/${t}`);return a}};var ke={namespaced:!0,state(){return{category:[]}},mutations:{setCategory(e,t){e.category.push(t)},loadCategory(e,t){e.category=t},updateMessage(e,t){e.category[e.category.findIndex((e=>e.id===t.id))]=t}},actions:{async createCategory({commit:e},t){try{const a=ce.getUserId(),n=await be.create(t,a);e("setCategory",{...t,id:n.name}),(0,Y.U)("Категория успешно создана")}catch(a){throw(0,Y.P)((0,G.Z)(a)),a}},async getAllCategory({commit:e}){try{const t=ce.getUserId(),a=await be.get(t);if(a){const t=Object.keys(a).map((e=>({id:e,...a[e]})));return e("loadCategory",t),t}}catch(t){throw(0,Y.P)("Не удалось загрузить категории"),t}},async updateCategory({commit:e},t){try{const a=ce.getUserId(),n=await be.update(t,a);n&&(e("updateMessage",n),(0,Y.U)("Категория успешно изменена"))}catch(a){throw(0,Y.P)("Не удалось изменить категорию"),a}},async getCategoryById(e,t){try{const e=ce.getUserId(),a=await be.getById(e,t);if(a)return{...a,id:t}}catch(a){throw(0,Y.P)("Не удалось загрузить данные"),a}}},getters:{category(e){return e.category}}};const _e={create:async(e,t)=>{const{data:a}=await me.post(`/users/${t}/records`,e);return a},get:async e=>{const{data:t}=await me.get(`/users/${e}/records`);return t},getById:async(e,t)=>{const{data:a}=await me.get(`/users/${e}/records/${t}`);return a}};var Ie={namespaced:!0,state(){return{records:[]}},mutations:{setRecord(e,t){e.records.push(t)},setAllRecords(e,t){e.records=t}},actions:{async createRecord({commit:e},t){try{const a=ce.getUserId(),n=await _e.create(t,a);e("setRecord",{...t,id:n.name})}catch(a){throw(0,Y.P)("Не удалось создать запись"),a}},async getAllRecords({commit:e}){try{const t=ce.getUserId(),a=await _e.get(t);if(a){const t=Object.keys(a).map((e=>({id:e,...a[e]})));return e("setAllRecords",t),t}}catch(t){throw(0,Y.P)("Не удалось загрузить данные"),t}},async getRecordById(e,t){try{const e=ce.getUserId(),a=await _e.getById(e,t);if(a)return{...a,id:t}}catch(a){throw(0,Y.P)("Не удалось загрузить данные"),a}}}},Se=(0,x.MT)({state:{},getters:{},mutations:{},actions:{async fetchCurrency(){let e=new Headers;e.append("apikey","c0EDmLIaemQc9pHypkU6hWuZ18DXKsvt");let t={method:"GET",redirect:"follow",headers:e};const a=await fetch("https://api.apilayer.com/fixer/latest?symbols=USD,RUB,EUR",t);return await a.json()}},modules:{auth:we,category:ke,record:Ie}});const Ae=[{path:"/",name:"home",component:()=>a.e(568).then(a.bind(a,1568)),meta:{layout:"main",auth:!0}},{path:"/logout",name:"logout",component:()=>a.e(179).then(a.bind(a,179)),meta:{layout:"auth",auth:!0}},{path:"/categories",name:"categories",component:()=>Promise.all([a.e(472),a.e(891)]).then(a.bind(a,1891)),meta:{layout:"main",auth:!0}},{path:"/record/:id",name:"details-record",component:()=>a.e(901).then(a.bind(a,6901)),meta:{layout:"main",auth:!0}},{path:"/history",name:"history",component:()=>a.e(693).then(a.bind(a,693)),meta:{layout:"main",auth:!0}},{path:"/planning",name:"planning",component:()=>a.e(148).then(a.bind(a,148)),meta:{layout:"main",auth:!0}},{path:"/profile",name:"profile",component:()=>Promise.all([a.e(472),a.e(835)]).then(a.bind(a,1179)),meta:{layout:"main",auth:!0}},{path:"/record",name:"record",component:()=>Promise.all([a.e(472),a.e(393)]).then(a.bind(a,3393)),meta:{layout:"main",auth:!0}},{path:"/login",name:"login",component:()=>Promise.all([a.e(472),a.e(525)]).then(a.bind(a,6525)),meta:{layout:"auth",auth:!1}},{path:"/register",name:"register",component:()=>Promise.all([a.e(472),a.e(778)]).then(a.bind(a,2778)),meta:{layout:"auth",auth:!1}},{path:"/:pathMatch(.*)*",name:"PageNotFound",component:()=>a.e(225).then(a.bind(a,8225)),meta:{layout:"auth",auth:!1}}],Te=(0,D.p7)({history:(0,D.PO)("/"),routes:Ae,linkActiveClass:"active",linkExactActiveClass:"active"});Te.beforeEach(((e,t,a)=>{const n=e.meta.auth;n&&Se.getters["auth/isAuthenticated"]?a():n&&!Se.getters["auth/isAuthenticated"]?a("/login?message=auth"):a()}));var je=Te;a(5778);(0,n.ri)(q).use(Se).use(je).mount("#app")},2316:function(e,t,a){function n(e){window.M.toast({html:e})}function r(e){window.M.toast({html:`Ошибка: ${e}`})}a.d(t,{P:function(){return r},U:function(){return n}})},6270:function(e,t){t["Z"]={logout:"Вы вышли из системы",EMAIL_NOT_FOUND:"Неверная почта или пароль",INVALID_PASSWORD:"Неверная почта или пароль",auth:"Пожалуйста войдите в систему",EMAIL_EXISTS:"Данная почта уже есть в системе"}},9877:function(e,t,a){a.d(t,{Z:function(){return d}});var n=a(3396);const r={class:"app-loader"},o=(0,n.uE)('<div class="preloader-wrapper active"><div class="spinner-layer spinner-red-only"><div class="circle-clipper left"><div class="circle"></div></div><div class="gap-patch"><div class="circle"></div></div><div class="circle-clipper right"><div class="circle"></div></div></div></div>',1),s=[o];function i(e,t,a,o,i,c){return(0,n.wg)(),(0,n.iD)("div",r,s)}var c={},u=a(89);const l=(0,u.Z)(c,[["render",i]]);var d=l}},t={};function a(n){var r=t[n];if(void 0!==r)return r.exports;var o=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(o.exports,o,o.exports,a),o.loaded=!0,o.exports}a.m=e,function(){var e=[];a.O=function(t,n,r,o){if(!n){var s=1/0;for(l=0;l<e.length;l++){n=e[l][0],r=e[l][1],o=e[l][2];for(var i=!0,c=0;c<n.length;c++)(!1&o||s>=o)&&Object.keys(a.O).every((function(e){return a.O[e](n[c])}))?n.splice(c--,1):(i=!1,o<s&&(s=o));if(i){e.splice(l--,1);var u=r();void 0!==u&&(t=u)}}return t}o=o||0;for(var l=e.length;l>0&&e[l-1][2]>o;l--)e[l]=e[l-1];e[l]=[n,r,o]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){a.f={},a.e=function(e){return Promise.all(Object.keys(a.f).reduce((function(t,n){return a.f[n](e,t),t}),[]))}}(),function(){a.u=function(e){return"js/"+e+"."+{148:"4cf7bad5",179:"961086f4",225:"9292ace6",393:"674e3008",472:"8a15a3a9",525:"ec1ec541",568:"793162e1",693:"8db5baa7",778:"156c3b4b",835:"ec524de7",891:"c8e942ed",901:"dae6553d"}[e]+".js"}}(),function(){a.miniCssF=function(e){}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="srm:";a.l=function(n,r,o,s){if(e[n])e[n].push(r);else{var i,c;if(void 0!==o)for(var u=document.getElementsByTagName("script"),l=0;l<u.length;l++){var d=u[l];if(d.getAttribute("src")==n||d.getAttribute("data-webpack")==t+o){i=d;break}}i||(c=!0,i=document.createElement("script"),i.charset="utf-8",i.timeout=120,a.nc&&i.setAttribute("nonce",a.nc),i.setAttribute("data-webpack",t+o),i.src=n),e[n]=[r];var p=function(t,a){i.onerror=i.onload=null,clearTimeout(g);var r=e[n];if(delete e[n],i.parentNode&&i.parentNode.removeChild(i),r&&r.forEach((function(e){return e(a)})),t)return t(a)},g=setTimeout(p.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=p.bind(null,i.onerror),i.onload=p.bind(null,i.onload),c&&document.head.appendChild(i)}}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){a.p="/"}(),function(){var e={143:0};a.f.j=function(t,n){var r=a.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var o=new Promise((function(a,n){r=e[t]=[a,n]}));n.push(r[2]=o);var s=a.p+a.u(t),i=new Error,c=function(n){if(a.o(e,t)&&(r=e[t],0!==r&&(e[t]=void 0),r)){var o=n&&("load"===n.type?"missing":n.type),s=n&&n.target&&n.target.src;i.message="Loading chunk "+t+" failed.\n("+o+": "+s+")",i.name="ChunkLoadError",i.type=o,i.request=s,r[1](i)}};a.l(s,c,"chunk-"+t,t)}},a.O.j=function(t){return 0===e[t]};var t=function(t,n){var r,o,s=n[0],i=n[1],c=n[2],u=0;if(s.some((function(t){return 0!==e[t]}))){for(r in i)a.o(i,r)&&(a.m[r]=i[r]);if(c)var l=c(a)}for(t&&t(n);u<s.length;u++)o=s[u],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return a.O(l)},n=self["webpackChunksrm"]=self["webpackChunksrm"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=a.O(void 0,[998],(function(){return a(8258)}));n=a.O(n)})();
//# sourceMappingURL=app.51aaedc4.js.map