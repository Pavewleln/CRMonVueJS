{"version":3,"file":"js/393.674e3008.js","mappings":"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","sources":["webpack://srm/./src/views/MainRecord.vue","webpack://srm/./src/hooks/record-form.js","webpack://srm/./src/views/MainRecord.vue?2b6c"],"sourcesContent":["<template>\n  <div class=\"app-page\">\n    <div>\n      <div class=\"page-title\">\n        <h3>Новая запись</h3>\n      </div>\n\n      <AppLoader v-if=\"loading\"/>\n      <p class=\"center\" v-else-if=\"!categories.length\">Категорий пока нет.\n        <router-link to=\"/categories\">Добавить категорию</router-link>\n      </p>\n      <form class=\"form\" v-else @submit.prevent=\"onSubmit\">\n        <div class=\"input-field\">\n          <select ref=\"select\" v-model=\"category\">\n            <option v-for=\"c in categories\" :key=\"c.id\" :value=\"c.id\">{{ c.title }}</option>\n          </select>\n          <label>Выберите категорию</label>\n          <p class=\"helper-text invalid\" v-if=\"cError\">{{cError}}</p>\n        </div>\n\n        <p>\n          <label>\n            <input\n              checked\n              class=\"with-gap\"\n              name=\"type\"\n              type=\"radio\"\n              value=\"income\"\n              v-model=\"type\"\n            />\n            <span>Доход</span>\n          </label>\n        </p>\n\n        <p>\n          <label>\n            <input\n              class=\"with-gap\"\n              name=\"type\"\n              type=\"radio\"\n              value=\"outcome\"\n              v-model=\"type\"\n            />\n            <span>Расход</span>\n          </label>\n        </p>\n\n        <div class=\"input-field\">\n          <input\n            id=\"amount\"\n            type=\"number\"\n            v-model=\"amount\"\n            @blur=\"aBlur\"\n          >\n          <label for=\"amount\">Сумма</label>\n          <span class=\"helper-text invalid\" v-if=\"aError\">{{ aError }}</span>\n        </div>\n\n        <div class=\"input-field\">\n          <input\n            id=\"description\"\n            type=\"text\"\n            v-model=\"description\"\n            @blur=\"dBlur\"\n          >\n          <label for=\"description\">Описание</label>\n          <span\n            class=\"helper-text invalid\" v-if=\"dError\">{{ dError }}</span>\n        </div>\n\n        <button class=\"btn waves-effect waves-light\" type=\"submit\">\n          Создать\n          <i class=\"material-icons right\">send</i>\n        </button>\n      </form>\n    </div>\n\n  </div>\n</template>\n\n<script>\nimport {computed, onMounted, onUnmounted, ref} from \"vue\";\nimport {useStore} from \"vuex\";\nimport AppLoader from \"@/components/app/AppLoader\";\nimport {RecordForm} from \"@/hooks/record-form\";\nimport {MessageToast} from \"@/utils/messagePlugin\";\n\nexport default {\n  components: {AppLoader},\n  setup: function () {\n    const select = ref(null)\n    const loading = ref(true)\n    const store = useStore()\n    onMounted(async () => {\n      loading.value = true\n      await store.dispatch('category/getAllCategory')\n      loading.value = false\n      setTimeout(() => {\n        select.value = window.M.FormSelect.init(select.value)\n      }, 0)\n    })\n    const categories = computed(() => store.getters[\"category/category\"])\n    onUnmounted(() => {\n      if (select.value && select.value.destroy) {\n        select.value.destroy()\n      }\n    })\n\n    const onSubmit = async  (values) => {\n      if (values.type === 'income') {\n        try{\n          await store.dispatch('record/createRecord', {\n            categoryId: values.category,\n            amount: values.amount,\n            description: values.description,\n            type: values.type,\n            date: new Date().toJSON()\n          })\n          const bill = store.getters['auth/info'].bill + values.amount\n          await store.dispatch('auth/updateInfo', {bill})\n          values = null\n          MessageToast('Запись успешно создана')\n        } catch (err){\n          console.log(err)\n        }\n      } else {\n        if(store.getters[\"auth/info\"].bill >= values.amount){\n          try {\n            await store.dispatch('record/createRecord', {\n              categoryId: values.category,\n              amount: values.amount,\n              description: values.description,\n              type: values.type,\n              date: new Date().toJSON()\n            })\n            const bill = store.getters['auth/info'].bill - values.amount\n            await store.dispatch('auth/updateInfo', {bill})\n            values.amount = ''\n            values.description = ''\n            MessageToast('Запись успешно создана')\n          } catch (err){\n            console.log(err)\n          }\n        }else {\n          MessageToast('У вас не достаточно средств')\n        }\n      }\n    }\n    return {\n      select,\n      categories,\n      loading,\n      ...RecordForm(onSubmit, categories)\n    }\n  }\n}\n</script>\n\n<style scoped>\n\n</style>\n","import {useField, useForm} from \"vee-validate\";\nimport * as yup from \"yup\";\n\nexport const RecordForm = (fn, categories) => {\n  const {handleSubmit, isSubmitting} = useForm()\n\n  const {value: type} = useField('type')\n  type.value = 'income'\n  const {value: amount, errorMessage: aError, handleBlur: aBlur} = useField('amount',\n    yup.number()\n      .min(1, 'Число должно быть больше 1')\n      .required('Обязательно для заполнения')\n  )\n  const {value: description, errorMessage: dError, handleBlur: dBlur} = useField('description',\n    yup.string()\n      .trim()\n      .required('Обязательно для заполнения')\n  )\n  const {value: category, errorMessage: cError} = useField('category',\n    yup.string()\n      .required('Обязательно для заполнения')\n  )\n  category.value = categories[0]\n\n  const onSubmit = handleSubmit(fn)\n\n  return {\n    isSubmitting,\n    type,\n    amount,\n    dError,\n    dBlur,\n    onSubmit,\n    category,\n    aError,\n    aBlur,\n    description,\n    cError\n  }\n}\n","import { render } from \"./MainRecord.vue?vue&type=template&id=69c1962d\"\nimport script from \"./MainRecord.vue?vue&type=script&lang=js\"\nexport * from \"./MainRecord.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"D:\\\\fullstack\\\\projects\\\\Frontend\\\\VUEJS\\\\srm\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","_createElementVNode","for","type","_createElementBlock","_hoisted_1","_hoisted_2","_ctx","_createBlock","_component_AppLoader","key","length","onSubmit","_hoisted_4","ref","_Fragment","c","id","value","title","_hoisted_6","_hoisted_7","checked","name","_hoisted_8","_hoisted_9","_hoisted_10","onBlur","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_3","_component_router_link","to","RecordForm","fn","categories","handleSubmit","isSubmitting","useForm","useField","amount","errorMessage","aError","handleBlur","aBlur","yup","min","required","description","dError","dBlur","trim","category","cError","components","AppLoader","setup","select","loading","store","useStore","onMounted","async","dispatch","setTimeout","window","M","FormSelect","init","computed","getters","onUnmounted","destroy","values","categoryId","date","Date","toJSON","bill","MessageToast","err","console","log","__exports__","render"],"sourceRoot":""}